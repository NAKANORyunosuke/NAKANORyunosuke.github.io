{
  "version": 3,
  "sources": ["../../src/ts/components/lang-switch.ts", "../../src/ts/components/menu.ts", "../../src/ts/components/last-updated.ts", "../../src/ts/components/animations.ts", "../../src/ts/main.ts"],
  "sourcesContent": ["export type Language = 'ja' | 'en';\r\n\r\nconst LANGUAGE_COOKIE = 'lang';\r\nconst LANGUAGE_STORAGE_KEY = 'preferred-lang';\r\nconst COOKIE_LIFETIME_DAYS = 30;\r\nconst LANGUAGE_EVENT = 'preferredlanguagechange';\r\n\r\nconst LANGUAGE_LABELS: Record<Language, string> = {\r\n  ja: '\u65E5\u672C\u8A9E',\r\n  en: 'English',\r\n};\r\n\r\nfunction isLanguage(value: string | null): value is Language {\r\n  return value === 'ja' || value === 'en';\r\n}\r\n\r\nfunction setCookie(name: string, value: string, days: number): void {\r\n  const expires = new Date(Date.now() + days * 864e5).toUTCString();\r\n  document.cookie = `${name}=${encodeURIComponent(value)}; expires=${expires}; path=/; SameSite=Lax`;\r\n}\r\n\r\nfunction getCookie(name: string): string | null {\r\n  if (!document.cookie) return null;\r\n  const parts = document.cookie.split(';');\r\n  for (const raw of parts) {\r\n    const trimmed = raw.trim();\r\n    if (!trimmed) continue;\r\n    const eq = trimmed.indexOf('=');\r\n    if (eq === -1) continue;\r\n    if (trimmed.slice(0, eq) === name) {\r\n      return decodeURIComponent(trimmed.slice(eq + 1));\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction storeLanguage(lang: Language): void {\r\n  setCookie(LANGUAGE_COOKIE, lang, COOKIE_LIFETIME_DAYS);\r\n  try {\r\n    window.localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);\r\n  } catch {\r\n    /* localStorage unavailable */\r\n  }\r\n}\r\n\r\nfunction loadStoredLanguage(): Language | null {\r\n  try {\r\n    const stored = window.localStorage.getItem(LANGUAGE_STORAGE_KEY);\r\n    if (isLanguage(stored)) return stored;\r\n  } catch {\r\n    /* ignore */\r\n  }\r\n  const cookie = getCookie(LANGUAGE_COOKIE);\r\n  return isLanguage(cookie) ? cookie : null;\r\n}\r\n\r\nfunction detectBrowserLanguage(): Language {\r\n  const sources = Array.isArray(navigator.languages) && navigator.languages.length ? navigator.languages : [navigator.language];\r\n  for (const value of sources) {\r\n    if (typeof value === 'string' && value.toLowerCase().startsWith('ja')) {\r\n      return 'ja';\r\n    }\r\n  }\r\n  return 'en';\r\n}\r\n\r\nfunction getUrlLanguage(): Language | null {\r\n  try {\r\n    const params = new URLSearchParams(window.location.search);\r\n    const lang = params.get('lang');\r\n    return isLanguage(lang) ? lang : null;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction updateDocumentLanguage(lang: Language): void {\r\n  const html = document.documentElement;\r\n  if (html.getAttribute('lang') !== lang) html.setAttribute('lang', lang);\r\n  if (html.getAttribute('data-lang') !== lang) html.setAttribute('data-lang', lang);\r\n\r\n  const selector = document.getElementById('lang-select') as HTMLSelectElement | null;\r\n  if (selector && selector.value !== lang) selector.value = lang;\r\n\r\n  document.dispatchEvent(new CustomEvent<Language>(LANGUAGE_EVENT, { detail: lang }));\r\n}\r\n\r\nfunction chooseInitialLanguage(): Language {\r\n  const urlLang = getUrlLanguage();\r\n  if (urlLang) return urlLang;\r\n\r\n  const stored = loadStoredLanguage();\r\n  if (stored) return stored;\r\n\r\n  return detectBrowserLanguage();\r\n}\r\n\r\nexport function initLangSwitch(): void {\r\n  const selector = document.getElementById('lang-select') as HTMLSelectElement | null;\r\n  const initial = chooseInitialLanguage();\r\n  storeLanguage(initial);\r\n  updateDocumentLanguage(initial);\r\n\r\n  if (selector) {\r\n    selector.setAttribute('aria-label', 'Select language');\r\n    selector.setAttribute('title', 'Select language');\r\n    selector.addEventListener('change', (event) => {\r\n      const target = event.target as HTMLSelectElement | null;\r\n      if (!target) return;\r\n      const value = target.value;\r\n      if (!isLanguage(value)) return;\r\n      storeLanguage(value);\r\n      updateDocumentLanguage(value);\r\n    });\r\n  }\r\n}\r\n\r\nexport { LANGUAGE_EVENT, LANGUAGE_LABELS };\r\n", "import { LANGUAGE_EVENT, Language, LANGUAGE_LABELS } from './lang-switch';\r\n\r\nconst MENU_ICON_OPEN = '\u2630';\r\nconst MENU_ICON_CLOSE = '\u2715';\r\nconst NAV_ID = 'primary-nav';\r\n\r\nconst MENU_LABELS: Record<Language, { open: string; close: string }> = {\r\n  ja: { open: '\u30E1\u30CB\u30E5\u30FC\u3092\u958B\u304F', close: '\u30E1\u30CB\u30E5\u30FC\u3092\u9589\u3058\u308B' },\r\n  en: { open: 'Open menu', close: 'Close menu' },\r\n};\r\n\r\nfunction updateMenuButton(button: HTMLButtonElement, isOpen: boolean, lang: Language): void {\r\n  const labels = MENU_LABELS[lang] || MENU_LABELS.ja;\r\n  button.textContent = isOpen ? MENU_ICON_CLOSE : MENU_ICON_OPEN;\r\n  button.setAttribute('aria-expanded', String(isOpen));\r\n  button.setAttribute('aria-label', isOpen ? labels.close : labels.open);\r\n}\r\n\r\nfunction closeMenu(nav: HTMLElement, button: HTMLButtonElement, lang: Language): void {\r\n  if (nav.classList.contains('is-open')) {\r\n    nav.classList.remove('is-open');\r\n    updateMenuButton(button, false, lang);\r\n  }\r\n}\r\n\r\nexport function initMenuToggle(): void {\r\n  const nav = document.getElementById(NAV_ID) as HTMLElement | null;\r\n  const button = document.querySelector<HTMLButtonElement>('.menu-btn');\r\n  if (!nav || !button) return;\r\n\r\n  const getCurrentLanguage = (): Language => {\r\n    const lang = document.documentElement.getAttribute('data-lang') || document.documentElement.getAttribute('lang') || 'ja';\r\n    return lang === 'en' ? 'en' : 'ja';\r\n  };\r\n\r\n  const initialLang = getCurrentLanguage();\r\n  updateMenuButton(button, nav.classList.contains('is-open'), initialLang);\r\n\r\n  button.addEventListener('click', () => {\r\n    const lang = getCurrentLanguage();\r\n    const isOpen = nav.classList.toggle('is-open');\r\n    updateMenuButton(button, isOpen, lang);\r\n  });\r\n\r\n  nav.addEventListener('click', (event) => {\r\n    const target = event.target as HTMLElement | null;\r\n    if (!target) return;\r\n    if (target.tagName.toLowerCase() === 'a' && window.matchMedia('(max-width: 980px)').matches) {\r\n      closeMenu(nav, button, getCurrentLanguage());\r\n    }\r\n  });\r\n\r\n  document.addEventListener(LANGUAGE_EVENT, (event) => {\r\n    const lang = (event as CustomEvent<Language>).detail || getCurrentLanguage();\r\n    const isOpen = nav.classList.contains('is-open');\r\n    updateMenuButton(button, isOpen, lang);\r\n    button.setAttribute('title', LANGUAGE_LABELS[lang] || LANGUAGE_LABELS.ja);\r\n  });\r\n}\r\n", "function formatWithPadding(value: number): string {\r\n  return String(value).padStart(2, '0');\r\n}\r\n\r\nexport function initLastUpdated(): void {\r\n  const lastJa = document.getElementById('last-updated-ja');\r\n  const lastEn = document.getElementById('last-updated-en');\r\n  if (!lastJa && !lastEn) return;\r\n\r\n  const d = new Date(document.lastModified);\r\n  const yyyy = d.getFullYear();\r\n  const mm = formatWithPadding(d.getMonth() + 1);\r\n  const dd = formatWithPadding(d.getDate());\r\n  const hh = formatWithPadding(d.getHours());\r\n  const mi = formatWithPadding(d.getMinutes());\r\n\r\n  if (lastJa) {\r\n    lastJa.textContent = `${yyyy}\u5E74${mm}\u6708${dd}\u65E5 ${hh}:${mi}`;\r\n  }\r\n  if (lastEn) {\r\n    lastEn.textContent = `${yyyy}-${mm}-${dd} ${hh}:${mi}`;\r\n  }\r\n}\r\n", "export function initScrollAnimations(): void {\r\n  const animatedElements = document.querySelectorAll<HTMLElement>('.reveal-on-scroll');\r\n  if (!('IntersectionObserver' in window) || animatedElements.length === 0) return;\r\n\r\n  const observer = new IntersectionObserver(\r\n    (entries, obs) => {\r\n      entries.forEach((entry) => {\r\n        if (entry.isIntersecting) {\r\n          entry.target.classList.add('is-visible');\r\n          obs.unobserve(entry.target);\r\n        }\r\n      });\r\n    },\r\n    { root: null, rootMargin: '0px', threshold: 0.1 },\r\n  );\r\n\r\n  animatedElements.forEach((el, index) => {\r\n    el.style.transitionDelay = `${(index % 5) * 100}ms`;\r\n    observer.observe(el);\r\n  });\r\n}\r\n", "import { initLangSwitch } from './components/lang-switch';\r\nimport { initMenuToggle } from './components/menu';\r\nimport { initLastUpdated } from './components/last-updated';\r\nimport { initScrollAnimations } from './components/animations';\r\n\r\nfunction renderMathIfReady(): void {\r\n  const render = (window as unknown as { renderMathInElement?: Function }).renderMathInElement;\r\n  if (typeof render !== 'function') return;\r\n\r\n  render(document.body, {\r\n    delimiters: [\r\n      { left: '$$', right: '$$', display: true },\r\n      { left: '\\\\[', right: '\\\\]', display: true },\r\n      { left: '$', right: '$', display: false },\r\n      { left: '\\\\(', right: '\\\\)', display: false },\r\n    ],\r\n    throwOnError: false,\r\n    strict: false,\r\n    ignoredTags: ['script', 'noscript', 'style', 'textarea', 'code', 'pre'],\r\n  });\r\n}\r\n\r\nfunction initMathRender(): void {\r\n  if (document.readyState !== 'loading') renderMathIfReady();\r\n  document.addEventListener('DOMContentLoaded', renderMathIfReady);\r\n  window.addEventListener('load', renderMathIfReady);\r\n}\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  initLangSwitch();\r\n  initMenuToggle();\r\n  initLastUpdated();\r\n  initScrollAnimations();\r\n  initMathRender();\r\n});\r\n"],
  "mappings": "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",
  "names": []
}
